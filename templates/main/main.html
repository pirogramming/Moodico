{% extends 'base.html' %} {% load static %} {% block extra_head %}
<link rel="stylesheet" href="{% static 'css/main/main.css' %}" />
<link rel="stylesheet" href="{% static 'css/upload/upload.css' %}" />
{% endblock%} {% block content %}
<div class="main-container">
  <div class="moodico-splash-container">
    <div class="moodico-banner">
      <h3>Moodico"</h3>
      <p>당신의 무드에 완벽하게 어울리는 메이크업 조합을 찾아보세요</p>
    </div>
  </div>

  <!-- ✅ 추가: 퍼스널 컬러 온보딩 (나의 시안 통합) -->
  <section class="pc-section">
    <div class="pc-container">
      <div class="pc-hero pc-reveal">
        <div>
          <div class="pc-eyebrow">Tone-Match by Moodico</div>
          <h2 class="pc-title-xl">톤 걱정 끝.<br> 무디코 매트릭스가 다 맞춰줘요</h2>
          <p class="pc-subtitle">
            무디코는 <strong>톤 일치</strong>를 최우선으로, <strong>색상 매트릭스</strong>에서
            <strong>동일 톤 제품</strong>을 추려 <strong>바로 쓸 수 있는 조합</strong>으로 추천합니다.
            <strong>무드·보유템</strong>까지 반영해 실패를 줄여요.
          </p>
          <div style="display: flex; gap: 10px; margin-top: 16px">
            <a class="pc-btn primary" href="{% url 'personalcolor' %}"
              >더 알아보러가기</a
            >
          </div>
        </div>
        <div>
          <div class="matrix-section">
            <section class="color-matrix-container">
              <div class="quadrant-grid">
                <div class="quadrant top-left"></div>
                <div class="quadrant top-right"></div>
                <div class="quadrant bottom-left"></div>
                <div class="quadrant bottom-right"></div>
              </div>

              <div class="axis-label top-label">Light</div>
              <div class="axis-label bottom-label">Deep</div>
              <div class="axis-label left-label">Cool</div>
              <div class="axis-label right-label">Warm</div>
            <div>

              <div
                id="makeup-products-container"
                class="makeup-products-container"
              ></div>

              <!--유사 무드 제품 추천 구간 표시-->
              <!--
              <div id="mood-selection-area" class="mood-selection-area">
                <span class="mood-label">추천 구간</span>
                <div class="resizer top-left-resizer"></div>
                <div class="resizer top-right-resizer"></div>
                <div class="resizer bottom-left-resizer"></div>
                <div class="resizer bottom-right-resizer"></div>
              </div>
              -->
            </section>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- 주요 기능 섹션 -->
  <div class="main-features">
    <!-- 내 아이템 기반 검색 카드 -->
    <div class="feature-card item-search-card">
      <div class="card-header">
        <h3>🔍 내 아이템 기반 검색</h3>
        <p>가진 제품으로 완벽한 조합 찾기</p>
      </div>
      <div class="search-preview">
        <div class="search-icon">
          <img
            src="/static/images/eyedropper.svg"
            alt="색상 추출"
            class="search-image"
          />
        </div>
        <div class="search-info">
          <h4>색상 분석 기반 추천</h4>
          <p>제품 사진을 업로드하면 색상과 어울리는 조합을 추천해드려요</p>
        </div>
      </div>
      <a href="{% url 'my_item_recommendation'  %}" class="card-action"
        >사진 업로드하기 →</a
      >
    </div>

    <!-- 오늘의 추천 카드 -->
    <div class="feature-card recommendation-card">
      <div class="card-header">
        <h3>🎯 오늘의 추천</h3>
        <p>당신을 위한 맞춤 제품</p>
      </div>
      <div class="product-preview">
        <img
          src="{{ recommended_product.product_image|default:'/static/images/test.jpg' }}"
          alt="{{ recommended_product.product_name }}"
          onerror="this.src='/static/images/test.jpg'"
          class="product-image"
        />
        <div class="product-info">
          <h4>{{ recommended_product.product_name }}</h4>
          <p>
            {% if recommended_product.is_user_liked %} 💖 내가 찜한 제품 | {{
            recommended_product.product_brand }} {% else %} {{
            recommended_product.product_brand }} 💜 | {{
            recommended_product.like_count }}명이 찜함 {% endif %}
          </p>
        </div>
      </div>
    </div>

    <!-- 무드 테스트 미리보기 -->
    <div class="feature-card mood-test-card">
      <div class="card-header">
        <h3>💫 무드 테스트</h3>
        <p>나는 어떤 무드의 메이크업이 잘 어울릴까?</p>
      </div>
      <div class="mood-options">
        <button class="mood-option">로맨틱</button>
        <button class="mood-option">시크</button>
        <button class="mood-option">내추럴</button>
        <button class="mood-option">글램</button>
      </div>
      <a href="{% url 'mood_test' %}" class="card-action">테스트 시작하기 →</a>
    </div>

    <!-- 색상 매트릭스 미리보기 -->
    <div class="feature-card color-matrix-card">
      <div class="card-header">
        <h3>🌈 색상 매트릭스 바로가기</h3>
        <p>매트릭스에서 빠르게 원하는 무드의 제품을 찾아보세요!</p>
      </div>
      <div class="matrix-preview">
        <div class="mini-color-matrix">
          <div class="quadrant-grid">
            <div class="quadrant top-left">
              <div class="quadrant-content">
                <span class="quadrant-label">Light Cool</span>
                <div class="color-dots">
                  <div
                    class="color-dot"
                    style="background-color: #87ceeb"
                  ></div>
                  <div
                    class="color-dot"
                    style="background-color: #98fb98"
                  ></div>
                  <div
                    class="color-dot"
                    style="background-color: #f0f8ff"
                  ></div>
                </div>
              </div>
            </div>
            <div class="quadrant top-right">
              <div class="quadrant-content">
                <span class="quadrant-label">Light Warm</span>
                <div class="color-dots">
                  <div
                    class="color-dot"
                    style="background-color: #ffe4b5"
                  ></div>
                  <div
                    class="color-dot"
                    style="background-color: #f0e68c"
                  ></div>
                  <div
                    class="color-dot"
                    style="background-color: #ffb6c1"
                  ></div>
                </div>
              </div>
            </div>
            <div class="quadrant bottom-left">
              <div class="quadrant-content">
                <span class="quadrant-label">Deep Cool</span>
                <div class="color-dots">
                  <div
                    class="color-dot"
                    style="background-color: #4169e1"
                  ></div>
                  <div
                    class="color-dot"
                    style="background-color: #008b8b"
                  ></div>
                  <div
                    class="color-dot"
                    style="background-color: #4b0082"
                  ></div>
                </div>
              </div>
            </div>
            <div class="quadrant bottom-right">
              <div class="quadrant-content">
                <span class="quadrant-label">Deep Warm</span>
                <div class="color-dots">
                  <div
                    class="color-dot"
                    style="background-color: #8b4513"
                  ></div>
                  <div
                    class="color-dot"
                    style="background-color: #dc143c"
                  ></div>
                  <div
                    class="color-dot"
                    style="background-color: #ff4500"
                  ></div>
                </div>
              </div>
            </div>
          </div>
          <div class="axis-labels">
            <div class="axis-label top">Light</div>
            <div class="axis-label bottom">Deep</div>
            <div class="axis-label left">Cool</div>
            <div class="axis-label right">Warm</div>
          </div>
        </div>
      </div>
      <a href="{% url 'color_matrix_explore' %}" class="card-action"
        >매트릭스 보기 →</a
      >
    </div>

    <!-- 컬러 투표 박스 -->
    <div class="feature-card voting-card">
      <div class="card-header">
        <h3>🗳️ 컬러 투표</h3>
        <p>가장 인기있는 컬러는?</p>
      </div>
      <div class="voting-products">
        {% for product in top_liked_products|slice:":2" %}
        <div
          class="vote-product-card"
          data-product-id="{{ product.product_id }}"
        >
          <div class="product-vote-image">
            <img
              src="{{ product.product_image|default:'/static/images/test.jpg' }}"
              alt="{{ product.product_name }}"
              onerror="this.src='/static/images/test.jpg'"
            />
            <div class="vote-overlay">
              <span class="vote-count">❤️ {{ product.like_count }}</span>
            </div>
          </div>
          <div class="product-vote-info">
            <h4>{{ product.product_name }}</h4>
            <p>{{ product.product_brand }}</p>
            <div class="vote-progress">
              <div class="progress-bar">
                <div
                  class="progress-fill"
                  style="width: {% if forloop.first %}65{% else %}35{% endif %}%"
                ></div>
              </div>
              <span class="vote-percentage"
                >{% if forloop.first %}65{% else %}35{% endif %}%</span
              >
            </div>
          </div>
        </div>
        {% empty %}
        <div class="no-voting-products">
          <p>아직 인기 제품이 없어요. 첫 번째로 찜해보세요! 💖</p>
        </div>
        {% endfor %}
      </div>
      {% if top_liked_products %}
      <div class="voting-stats">
        <p>
          총 투표수: <strong>{{ top_liked_products|length }}</strong> | 실시간
          업데이트
        </p>
      </div>
      {% endif %}
    </div>
  </div>

  <!-- 현재 아이템 랭킹 섹션 -->
  <div class="ranking-section">
    <div class="section-header">
      <h2>🏆 현재 인기 아이템</h2>
      <p>사용자들이 가장 많이 찜한 인기 제품들을 확인해보세요</p>
    </div>

    <div class="ranking-preview">
      {% comment %} [{'product_id': 'ec733645-2d66-4fb4-b207-d740680acd73',
      'product_name': '04 빈티지 오션', 'product_brand': 'romand',
      'product_price': '9,900원', 'product_image':
      'https://romand.io/images/product/343/BZgkQP0CTQ1Wb8FTVcLlVBqfPwSBpyZ3BeEQVdCu.jpg',
      'like_count': 1}, .. ] {% endcomment %} {% for product in top_liked_products %}
      <div class="ranking-item">
        <div class="ranking-badge">{{ forloop.counter }}</div>
        <img
          src="{{ product.product_image|default:'/static/images/test.jpg' }}"
          alt="{{ product.product_name }}"
          onerror="this.src='/static/images/test.jpg'"
        />
        <div class="ranking-info">
          <div class="product-brand">{{ product.product_brand }}</div>
          <div class="product-name">{{ product.product_name }}</div>
          <div class="like-count-display">
            💜 {{ product.like_count }} 명이 찜함
          </div>
        </div>
      </div>
      {% empty %}
      <div class="no-ranking">
        <p>아직 찜한 제품이 없어요. 첫 번째로 찜해보세요! 💖</p>
      </div>
      {% endfor %}
    </div>

    <div class="ranking-actions">
      <a href="{% url 'product_ranking' %}" class="ranking-detail-btn">
        자세히 보기 →
      </a>
    </div>
  </div>
</div>

<!-- JavaScript 파일 로드 -->
<script src="{% static 'js/main/main.js' %}"></script>

{% endblock %}
